<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üéÆ Tetris - Charlie's Hiring Chances Increase!</title>
    <link rel="stylesheet" href="elements.css">
    <style>
        #game-canvas {
            border: 5px ridge #00ff00;
            display: block;
            margin: 20px auto;
            box-shadow: 0 0 30px rgba(0, 255, 0, 0.6);
            background: #000;
        }
        .game-info {
            display: flex;
            justify-content: center;
            gap: 40px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        .info-box {
            background: rgba(0, 0, 0, 0.7);
            border: 3px ridge #00ffff;
            padding: 15px 25px;
            text-align: center;
        }
        .info-label {
            color: #00ffff;
            font-size: 14px;
            margin-bottom: 5px;
        }
        .info-value {
            color: #ffff00;
            font-size: 32px;
            font-weight: bold;
            text-shadow: 2px 2px #ff00ff;
        }
        #next-piece {
            border: 3px ridge #ff00ff;
            background: #000;
            margin: 10px auto;
        }
    </style>
</head>
<body>

<div class="wrapper">
    <h1>üéÆ TETRIS</h1>
    <marquee behavior="alternate" scrollamount="5">
        ‚ö° PLAY TETRIS ‚ö° BOOST HIRING CHANCES ‚ö° PROVE YOUR SKILLS ‚ö°
    </marquee>
    
    <p class="blink">Each line cleared = +10% hiring success rate!</p>
    
    <div class="game-info">
        <div class="info-box">
            <div class="info-label">SCORE</div>
            <div class="info-value" id="score">0</div>
        </div>
        <div class="info-box">
            <div class="info-label">LINES</div>
            <div class="info-value" id="lines">0</div>
        </div>
        <div class="info-box">
            <div class="info-label">LEVEL</div>
            <div class="info-value" id="level">1</div>
        </div>
    </div>
    
    <div style="text-align: center;">
        <h3 style="color: #ff00ff;">NEXT PIECE:</h3>
        <canvas id="next-piece" width="120" height="120"></canvas>
    </div>
    
    <canvas id="game-canvas" width="300" height="600"></canvas>
    
    <div class="box">
        <h3>üéÆ Controls:</h3>
        <ul style="list-style: none; padding: 0;">
            <li style="border: none;">‚¨ÖÔ∏è Arrow Left - Move Left</li>
            <li style="border: none;">‚û°Ô∏è Arrow Right - Move Right</li>
            <li style="border: none;">‚¨áÔ∏è Arrow Down - Soft Drop</li>
            <li style="border: none;">‚¨ÜÔ∏è Arrow Up - Rotate</li>
            <li style="border: none;">SPACE - Hard Drop</li>
            <li style="border: none;">P - Pause</li>
        </ul>
    </div>
    
    <div style="text-align: center; margin: 20px 0;">
        <button class="button" onclick="startGame()" id="start-btn">üéÆ Start Game</button>
        <button class="button" onclick="pauseGame()" id="pause-btn" style="display:none;">‚è∏Ô∏è Pause</button>
        <button class="button" onclick="resetGame()" id="reset-btn" style="display:none;">üîÑ Reset</button>
    </div>
    
    <div id="achievement" style="text-align: center; margin: 20px 0; min-height: 40px; font-size: 18px; color: #00ff00;"></div>
    
    <div class="box" style="background: rgba(255, 215, 0, 0.1); border-color: #ffd700;">
        <p style="text-align: center; font-style: italic;">
            üí° Pro Tip: The better you play, the more Charlie's skills become obvious!
        </p>
    </div>
    
    <div style="text-align: center; margin-top: 30px;">
        <a class="button" href="index.html">üè† Back to Homepage</a>
    </div>
</div>

<script>
const canvas = document.getElementById('game-canvas');
const ctx = canvas.getContext('2d');
const nextCanvas = document.getElementById('next-piece');
const nextCtx = nextCanvas.getContext('2d');

const ROWS = 20;
const COLS = 10;
const BLOCK_SIZE = 30;

// Tetromino shapes
const SHAPES = {
    I: [[1,1,1,1]],
    O: [[1,1], [1,1]],
    T: [[0,1,0], [1,1,1]],
    S: [[0,1,1], [1,1,0]],
    Z: [[1,1,0], [0,1,1]],
    J: [[1,0,0], [1,1,1]],
    L: [[0,0,1], [1,1,1]]
};

const COLORS = {
    I: '#00FFFF',
    O: '#FFFF00',
    T: '#FF00FF',
    S: '#00FF00',
    Z: '#FF0000',
    J: '#0000FF',
    L: '#FFA500'
};

let board = [];
let currentPiece = null;
let nextPiece = null;
let score = 0;
let lines = 0;
let level = 1;
let gameLoop = null;
let isPaused = false;
let gameStarted = false;
let dropSpeed = 1000;

// Initialize board
function initBoard() {
    board = [];
    for (let r = 0; r < ROWS; r++) {
        board[r] = [];
        for (let c = 0; c < COLS; c++) {
            board[r][c] = 0;
        }
    }
}

// Get random piece
function randomPiece() {
    const shapes = Object.keys(SHAPES);
    const shape = shapes[Math.floor(Math.random() * shapes.length)];
    return {
        shape: SHAPES[shape],
        color: COLORS[shape],
        x: Math.floor(COLS / 2) - 1,
        y: 0,
        type: shape
    };
}

// Draw block
function drawBlock(ctx, x, y, color) {
    ctx.fillStyle = color;
    ctx.fillRect(x * BLOCK_SIZE, y * BLOCK_SIZE, BLOCK_SIZE, BLOCK_SIZE);
    ctx.strokeStyle = '#000';
    ctx.strokeRect(x * BLOCK_SIZE, y * BLOCK_SIZE, BLOCK_SIZE, BLOCK_SIZE);
}

// Draw board
function drawBoard() {
    ctx.fillStyle = '#000';
    ctx.fillRect(0, 0, canvas.width, canvas.height);
    
    for (let r = 0; r < ROWS; r++) {
        for (let c = 0; c < COLS; c++) {
            if (board[r][c]) {
                drawBlock(ctx, c, r, board[r][c]);
            }
        }
    }
}

// Draw current piece
function drawPiece() {
    if (!currentPiece) return;
    
    for (let r = 0; r < currentPiece.shape.length; r++) {
        for (let c = 0; c < currentPiece.shape[r].length; c++) {
            if (currentPiece.shape[r][c]) {
                drawBlock(ctx, currentPiece.x + c, currentPiece.y + r, currentPiece.color);
            }
        }
    }
}

// Draw next piece
function drawNextPiece() {
    nextCtx.fillStyle = '#000';
    nextCtx.fillRect(0, 0, nextCanvas.width, nextCanvas.height);
    
    if (!nextPiece) return;
    
    const offsetX = (4 - nextPiece.shape[0].length) / 2;
    const offsetY = (4 - nextPiece.shape.length) / 2;
    
    for (let r = 0; r < nextPiece.shape.length; r++) {
        for (let c = 0; c < nextPiece.shape[r].length; c++) {
            if (nextPiece.shape[r][c]) {
                nextCtx.fillStyle = nextPiece.color;
                nextCtx.fillRect((offsetX + c) * 30, (offsetY + r) * 30, 30, 30);
                nextCtx.strokeStyle = '#000';
                nextCtx.strokeRect((offsetX + c) * 30, (offsetY + r) * 30, 30, 30);
            }
        }
    }
}

// Check collision
function checkCollision(piece, offsetX = 0, offsetY = 0) {
    for (let r = 0; r < piece.shape.length; r++) {
        for (let c = 0; c < piece.shape[r].length; c++) {
            if (piece.shape[r][c]) {
                const newX = piece.x + c + offsetX;
                const newY = piece.y + r + offsetY;
                
                if (newX < 0 || newX >= COLS || newY >= ROWS) {
                    return true;
                }
                if (newY >= 0 && board[newY][newX]) {
                    return true;
                }
            }
        }
    }
    return false;
}

// Merge piece to board
function mergePiece() {
    for (let r = 0; r < currentPiece.shape.length; r++) {
        for (let c = 0; c < currentPiece.shape[r].length; c++) {
            if (currentPiece.shape[r][c]) {
                const boardY = currentPiece.y + r;
                if (boardY >= 0) {
                    board[boardY][currentPiece.x + c] = currentPiece.color;
                }
            }
        }
    }
}

// Clear lines
function clearLines() {
    let linesCleared = 0;
    
    for (let r = ROWS - 1; r >= 0; r--) {
        if (board[r].every(cell => cell !== 0)) {
            board.splice(r, 1);
            board.unshift(new Array(COLS).fill(0));
            linesCleared++;
            r++; // Check same row again
        }
    }
    
    if (linesCleared > 0) {
        lines += linesCleared;
        score += linesCleared * 100 * level;
        
        // Update level
        level = Math.floor(lines / 10) + 1;
        dropSpeed = Math.max(100, 1000 - (level - 1) * 100);
        
        document.getElementById('score').textContent = score;
        document.getElementById('lines').textContent = lines;
        document.getElementById('level').textContent = level;
        
        // Achievements
        if (lines === 10) {
            showMessage('üéØ 10 lines! Charlie is clearly competent!');
        } else if (lines === 25) {
            showMessage('üî• 25 lines! Hiring probability: 90%!');
        } else if (lines === 50) {
            showMessage('üíé 50 lines! You NEED to email Charlie NOW!');
        } else if (linesCleared === 4) {
            showMessage('üèÜ TETRIS! +400 points! Pure skill!');
        }
    }
}

// Rotate piece
function rotatePiece() {
    const rotated = currentPiece.shape[0].map((_, i) =>
        currentPiece.shape.map(row => row[i]).reverse()
    );
    
    const original = currentPiece.shape;
    currentPiece.shape = rotated;
    
    if (checkCollision(currentPiece)) {
        currentPiece.shape = original;
    }
}

// Move piece
function movePiece(dir) {
    if (!checkCollision(currentPiece, dir, 0)) {
        currentPiece.x += dir;
    }
}

// Drop piece
function dropPiece() {
    if (!checkCollision(currentPiece, 0, 1)) {
        currentPiece.y++;
    } else {
        mergePiece();
        clearLines();
        currentPiece = nextPiece;
        nextPiece = randomPiece();
        drawNextPiece();
        
        if (checkCollision(currentPiece)) {
            gameOver();
        }
    }
}

// Hard drop
function hardDrop() {
    while (!checkCollision(currentPiece, 0, 1)) {
        currentPiece.y++;
        score += 2;
    }
    document.getElementById('score').textContent = score;
    mergePiece();
    clearLines();
    currentPiece = nextPiece;
    nextPiece = randomPiece();
    drawNextPiece();
    
    if (checkCollision(currentPiece)) {
        gameOver();
    }
}

// Game loop
function update() {
    if (!isPaused && gameStarted) {
        dropPiece();
        draw();
    }
}

function draw() {
    drawBoard();
    drawPiece();
}

// Controls
document.addEventListener('keydown', (e) => {
    if (!gameStarted || isPaused) return;
    
    if (e.key === 'ArrowLeft') {
        movePiece(-1);
        draw();
    } else if (e.key === 'ArrowRight') {
        movePiece(1);
        draw();
    } else if (e.key === 'ArrowDown') {
        dropPiece();
        draw();
    } else if (e.key === 'ArrowUp') {
        rotatePiece();
        draw();
    } else if (e.key === ' ') {
        e.preventDefault();
        hardDrop();
        draw();
    } else if (e.key === 'p' || e.key === 'P') {
        pauseGame();
    }
});

// Start game
function startGame() {
    initBoard();
    score = 0;
    lines = 0;
    level = 1;
    dropSpeed = 1000;
    gameStarted = true;
    isPaused = false;
    
    document.getElementById('score').textContent = '0';
    document.getElementById('lines').textContent = '0';
    document.getElementById('level').textContent = '1';
    
    currentPiece = randomPiece();
    nextPiece = randomPiece();
    
    drawNextPiece();
    draw();
    
    if (gameLoop) clearInterval(gameLoop);
    gameLoop = setInterval(update, dropSpeed);
    
    document.getElementById('start-btn').style.display = 'none';
    document.getElementById('pause-btn').style.display = 'inline-block';
    document.getElementById('reset-btn').style.display = 'inline-block';
    
    showMessage('üéÆ Game started! Clear lines to boost hiring chances!');
}

// Pause game
function pauseGame() {
    if (!gameStarted) return;
    
    isPaused = !isPaused;
    const btn = document.getElementById('pause-btn');
    btn.textContent = isPaused ? '‚ñ∂Ô∏è Resume' : '‚è∏Ô∏è Pause';
    
    if (isPaused) {
        showMessage('‚è∏Ô∏è Game paused');
    } else {
        showMessage('‚ñ∂Ô∏è Game resumed');
    }
}

// Reset game
function resetGame() {
    if (gameLoop) clearInterval(gameLoop);
    gameStarted = false;
    isPaused = false;
    
    document.getElementById('start-btn').style.display = 'inline-block';
    document.getElementById('pause-btn').style.display = 'none';
    document.getElementById('reset-btn').style.display = 'none';
    
    initBoard();
    drawBoard();
    nextCtx.clearRect(0, 0, nextCanvas.width, nextCanvas.height);
    
    showMessage('üîÑ Game reset. Ready to play again!');
}

// Game over
function gameOver() {
    clearInterval(gameLoop);
    gameStarted = false;
    
    ctx.fillStyle = 'rgba(0, 0, 0, 0.8)';
    ctx.fillRect(0, 0, canvas.width, canvas.height);
    ctx.fillStyle = '#FF0000';
    ctx.font = 'bold 36px Comic Sans MS';
    ctx.textAlign = 'center';
    ctx.fillText('GAME OVER', canvas.width / 2, canvas.height / 2);
    
    ctx.fillStyle = '#FFFF00';
    ctx.font = '20px Comic Sans MS';
    ctx.fillText('Final Score: ' + score, canvas.width / 2, canvas.height / 2 + 40);
    ctx.fillText('Lines: ' + lines, canvas.width / 2, canvas.height / 2 + 70);
    
    document.getElementById('pause-btn').style.display = 'none';
    document.getElementById('reset-btn').style.display = 'inline-block';
    
    let message = '';
    if (score < 500) {
        message = 'üí™ Good try! Everyone starts somewhere!';
    } else if (score < 1500) {
        message = 'üéØ Solid effort! Hiring chances: 70%!';
    } else if (score < 3000) {
        message = 'üî• Impressive! Definitely email Charlie!';
    } else {
        message = 'üèÜ MASTER LEVEL! You MUST hire Charlie NOW! üöÄ';
    }
    
    setTimeout(() => {
        alert('GAME OVER!\n\nScore: ' + score + '\nLines: ' + lines + '\n\n' + message);
    }, 100);
}

function showMessage(msg) {
    const achDiv = document.getElementById('achievement');
    achDiv.textContent = msg;
    achDiv.style.animation = 'achievePulse 1s infinite';
    setTimeout(() => {
        achDiv.style.animation = '';
    }, 3000);
}

// Initialize
initBoard();
drawBoard();
</script>

</body>
</html>
